<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Bootloader: src/main.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="iti-logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">Bootloader<span id="projectnumber">&#160;v 1.0</span>
   </div>
   <div id="projectbrief">Bootloader for ITI Graduation Project</div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('main_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">main.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>The bootloader logic <br  />
 <b>Target</b> STM32F401CC (Black Pill)  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="_s_t_d___t_y_p_e_s_8h_source.html">LIB/STD_TYPES.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_b_i_t___m_a_t_h_8h_source.html">LIB/BIT_MATH.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_m_f_m_i__interface_8h_source.html">MCAL/FMI/MFMI_interface.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_m_r_c_c__interface_8h_source.html">MCAL/RCC/MRCC_interface.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_m_s_t_k__interface_8h_source.html">MCAL/STK/MSTK_interface.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_m_g_p_i_o__interface_8h_source.html">MCAL/GPIO/MGPIO_interface.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_m_u_a_r_t__interface_8h_source.html">MCAL/UART/MUART_interface.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_m_s_c_b__interface_8h_source.html">MCAL/SCB/MSCB_interface.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_s_hex_parser__interface_8h_source.html">Service/HexParser/SHexParser_interface.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for main.c:</div>
<div class="dyncontent">
<div class="center"><img src="main_8c__incl.png" border="0" usemap="#asrc_2main_8c" alt=""/></div>
<map name="asrc_2main_8c" id="asrc_2main_8c">
<area shape="rect" title="The bootloader logic &#160;&#160;Target STM32F401CC (Black Pill)" alt="" coords="789,5,872,32"/>
<area shape="rect" href="_s_t_d___t_y_p_e_s_8h.html" title="The standard types used in the projects." alt="" coords="5,88,136,115"/>
<area shape="poly" title=" " alt="" coords="789,24,519,39,335,57,148,83,129,86,128,81,147,77,334,51,518,34,789,19"/>
<area shape="rect" href="_b_i_t___m_a_t_h_8h.html" title="The bit manipulation functions like macro." alt="" coords="160,88,277,115"/>
<area shape="poly" title=" " alt="" coords="789,25,574,42,432,59,290,83,274,86,273,81,289,77,432,54,574,37,789,20"/>
<area shape="rect" href="_m_f_m_i__interface_8h.html" title="The Flash Memory Interface Header file that has all the prototypes and arguments of FMI driver." alt="" coords="301,88,488,115"/>
<area shape="poly" title=" " alt="" coords="789,30,500,83,476,87,475,82,499,77,788,25"/>
<area shape="rect" href="_m_r_c_c__interface_8h.html" title="The Reset Clock Control header file that has all the functions prototypes and arguments of the RCC dr..." alt="" coords="512,88,709,115"/>
<area shape="poly" title=" " alt="" coords="797,35,660,85,658,80,795,30"/>
<area shape="rect" href="_m_s_t_k__interface_8h.html" title="The Systick Timer interface header file that has all the Prototypes of STK driver." alt="" coords="734,88,927,115"/>
<area shape="poly" title=" " alt="" coords="833,33,833,73,828,73,828,33"/>
<area shape="rect" href="_m_g_p_i_o__interface_8h.html" title="the GPIO interface header file that contains the declarations of GPIO driver" alt="" coords="951,88,1158,115"/>
<area shape="poly" title=" " alt="" coords="866,30,1006,80,1004,85,865,35"/>
<area shape="rect" href="_m_u_a_r_t__interface_8h.html" title="The UART Interface Header file that has all the prototypes and arguments of UART driver." alt="" coords="1182,88,1394,115"/>
<area shape="poly" title=" " alt="" coords="873,25,1201,82,1200,87,872,30"/>
<area shape="rect" href="_m_s_c_b__interface_8h.html" title="The System Control Block C file that has all the functions prototypes and arguments of the SCB driver..." alt="" coords="1417,88,1615,115"/>
<area shape="poly" title=" " alt="" coords="872,21,1100,41,1406,77,1436,82,1435,87,1405,83,1099,47,872,26"/>
<area shape="rect" href="_s_hex_parser__interface_8h.html" title=" " alt="" coords="1639,80,1841,123"/>
<area shape="poly" title=" " alt="" coords="872,19,1181,36,1398,53,1624,77,1623,82,1397,59,1180,42,872,24"/>
</map>
</div>
</div>
<p><a href="main_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a3bb17f5daa2b1eaef58c8aa2d989e27e" id="r_a3bb17f5daa2b1eaef58c8aa2d989e27e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a3bb17f5daa2b1eaef58c8aa2d989e27e">TX_PIN</a>&#160;&#160;&#160;<a class="el" href="_m_g_p_i_o__interface_8h.html#a36ea3f65f6d277c35ac3e164a98db1aa">GPIO_PIN9</a></td></tr>
<tr class="memdesc:a3bb17f5daa2b1eaef58c8aa2d989e27e"><td class="mdescLeft">&#160;</td><td class="mdescRight">The Transmitter PIN of USART1.  <br /></td></tr>
<tr class="separator:a3bb17f5daa2b1eaef58c8aa2d989e27e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7089c01538b339ae745173c117f95b9" id="r_aa7089c01538b339ae745173c117f95b9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#aa7089c01538b339ae745173c117f95b9">RX_PIN</a>&#160;&#160;&#160;<a class="el" href="_m_g_p_i_o__interface_8h.html#ad2801886720d62e87a3dcfc62e9bae95">GPIO_PIN10</a></td></tr>
<tr class="memdesc:aa7089c01538b339ae745173c117f95b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">The Receiver PIN of USART1.  <br /></td></tr>
<tr class="separator:aa7089c01538b339ae745173c117f95b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a9c26879df40a5e80c53bcd969a9990c5" id="r_a9c26879df40a5e80c53bcd969a9990c5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a9c26879df40a5e80c53bcd969a9990c5">APP_voidStartApplication</a> (void)</td></tr>
<tr class="memdesc:a9c26879df40a5e80c53bcd969a9990c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">A function that set the start address of vector table and application.  <br /></td></tr>
<tr class="separator:a9c26879df40a5e80c53bcd969a9990c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6288eba0f8e8ad3ab1544ad731eb7667" id="r_a6288eba0f8e8ad3ab1544ad731eb7667"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a6288eba0f8e8ad3ab1544ad731eb7667">main</a> (void)</td></tr>
<tr class="memdesc:a6288eba0f8e8ad3ab1544ad731eb7667"><td class="mdescLeft">&#160;</td><td class="mdescRight">The sequence of the bootloader.  <br /></td></tr>
<tr class="separator:a6288eba0f8e8ad3ab1544ad731eb7667"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ad0c6ac1573c545cef564e2662673979d" id="r_ad0c6ac1573c545cef564e2662673979d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_s_t_d___t_y_p_e_s_8h.html#a2ff401e087cf786c38a6812723e94473">s8</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#ad0c6ac1573c545cef564e2662673979d">ReceiveBuffer</a> [100]</td></tr>
<tr class="memdesc:ad0c6ac1573c545cef564e2662673979d"><td class="mdescLeft">&#160;</td><td class="mdescRight">This array will receive the new update records.  <br /></td></tr>
<tr class="separator:ad0c6ac1573c545cef564e2662673979d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1a38ba7894421299f56d8d39b4d6958" id="r_ac1a38ba7894421299f56d8d39b4d6958"><td class="memItemLeft" align="right" valign="top">volatile <a class="el" href="_s_t_d___t_y_p_e_s_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#ac1a38ba7894421299f56d8d39b4d6958">u8RecCounter</a> = 0</td></tr>
<tr class="memdesc:ac1a38ba7894421299f56d8d39b4d6958"><td class="mdescLeft">&#160;</td><td class="mdescRight">The record counter.  <br /></td></tr>
<tr class="separator:ac1a38ba7894421299f56d8d39b4d6958"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5a7d330b0942455f9bb055921216ea9" id="r_ae5a7d330b0942455f9bb055921216ea9"><td class="memItemLeft" align="right" valign="top">volatile <a class="el" href="_s_t_d___t_y_p_e_s_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#ae5a7d330b0942455f9bb055921216ea9">TimeOutFlag</a> = 0</td></tr>
<tr class="memdesc:ae5a7d330b0942455f9bb055921216ea9"><td class="mdescLeft">&#160;</td><td class="mdescRight">The time out flag which indicated that the bootloader has finished it task.  <br /></td></tr>
<tr class="separator:ae5a7d330b0942455f9bb055921216ea9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab771d0d041fa7fa0b7c0a52e5e6d0f19" id="r_ab771d0d041fa7fa0b7c0a52e5e6d0f19"><td class="memItemLeft" align="right" valign="top">volatile <a class="el" href="_s_t_d___t_y_p_e_s_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#ab771d0d041fa7fa0b7c0a52e5e6d0f19">u8WriteReq</a> = 1</td></tr>
<tr class="memdesc:ab771d0d041fa7fa0b7c0a52e5e6d0f19"><td class="mdescLeft">&#160;</td><td class="mdescRight">This flag indicated for the start of writing in a bank.  <br /></td></tr>
<tr class="separator:ab771d0d041fa7fa0b7c0a52e5e6d0f19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5059b2482ec12efa628ffcb5415dfa79" id="r_a5059b2482ec12efa628ffcb5415dfa79"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_s_t_d___t_y_p_e_s_8h.html#af5d0313d23964b7ba53802e2bb5e5efa">pf</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a5059b2482ec12efa628ffcb5415dfa79">EntryPoint</a> = <a class="el" href="_s_t_d___t_y_p_e_s_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></td></tr>
<tr class="memdesc:a5059b2482ec12efa628ffcb5415dfa79"><td class="mdescLeft">&#160;</td><td class="mdescRight">The entry point of the application which will be jumped to it after the bootloader finish.  <br /></td></tr>
<tr class="separator:a5059b2482ec12efa628ffcb5415dfa79"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The bootloader logic <br  />
 <b>Target</b> STM32F401CC (Black Pill) </p>
<dl class="section author"><dt>Author</dt><dd>Hosam Ayoub </dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.0 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>1 Oct 2023 </dd></dl>

<p class="definition">Definition in file <a class="el" href="main_8c_source.html">main.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="aa7089c01538b339ae745173c117f95b9" name="aa7089c01538b339ae745173c117f95b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7089c01538b339ae745173c117f95b9">&#9670;&#160;</a></span>RX_PIN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RX_PIN&#160;&#160;&#160;<a class="el" href="_m_g_p_i_o__interface_8h.html#ad2801886720d62e87a3dcfc62e9bae95">GPIO_PIN10</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The Receiver PIN of USART1. </p>

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00020">20</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a id="a3bb17f5daa2b1eaef58c8aa2d989e27e" name="a3bb17f5daa2b1eaef58c8aa2d989e27e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3bb17f5daa2b1eaef58c8aa2d989e27e">&#9670;&#160;</a></span>TX_PIN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TX_PIN&#160;&#160;&#160;<a class="el" href="_m_g_p_i_o__interface_8h.html#a36ea3f65f6d277c35ac3e164a98db1aa">GPIO_PIN9</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The Transmitter PIN of USART1. </p>

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00019">19</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a9c26879df40a5e80c53bcd969a9990c5" name="a9c26879df40a5e80c53bcd969a9990c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c26879df40a5e80c53bcd969a9990c5">&#9670;&#160;</a></span>APP_voidStartApplication()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void APP_voidStartApplication </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A function that set the start address of vector table and application. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">none</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>none</dd></dl>
<p>There are two trigger that will call this function, the first trigger is if there wasn't any update for 10 ms, and the second trigger is if there was update and the bootloader has burn the update to its banks successfully </p>

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00038">38</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="main_8c_a9c26879df40a5e80c53bcd969a9990c5_cgraph.png" border="0" usemap="#amain_8c_a9c26879df40a5e80c53bcd969a9990c5_cgraph" alt=""/></div>
<map name="amain_8c_a9c26879df40a5e80c53bcd969a9990c5_cgraph" id="amain_8c_a9c26879df40a5e80c53bcd969a9990c5_cgraph">
<area shape="rect" title="A function that set the start address of vector table and application." alt="" coords="5,31,175,57"/>
<area shape="rect" href="_m_s_c_b__program_8c.html#a724b5aeeca3086037aafa4b685b5d7b8" title="This function set the vector table of the microcontroller." alt="" coords="225,5,403,32"/>
<area shape="poly" title=" " alt="" coords="175,32,209,28,210,33,175,37"/>
<area shape="rect" href="_m_s_t_k__program_8c.html#a06f7aa2eae169670786e8c13c7b04c70" title="This funciton is used to calculate the elapsed time from it starts to count." alt="" coords="223,56,405,83"/>
<area shape="poly" title=" " alt="" coords="175,51,207,55,207,60,175,56"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="main_8c_a9c26879df40a5e80c53bcd969a9990c5_icgraph.png" border="0" usemap="#amain_8c_a9c26879df40a5e80c53bcd969a9990c5_icgraph" alt=""/></div>
<map name="amain_8c_a9c26879df40a5e80c53bcd969a9990c5_icgraph" id="amain_8c_a9c26879df40a5e80c53bcd969a9990c5_icgraph">
<area shape="rect" title="A function that set the start address of vector table and application." alt="" coords="103,5,272,32"/>
<area shape="rect" href="main_8c.html#a6288eba0f8e8ad3ab1544ad731eb7667" title="The sequence of the bootloader." alt="" coords="5,5,55,32"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="a6288eba0f8e8ad3ab1544ad731eb7667" name="a6288eba0f8e8ad3ab1544ad731eb7667"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6288eba0f8e8ad3ab1544ad731eb7667">&#9670;&#160;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void main </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The sequence of the bootloader. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">none</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>none</dd></dl>
<p>The main logic of the bootloader which is waiting 10 ms to check if there was update or not</p><ul>
<li>If there wasn't a new update it will check which bank has a valid application then jump to it</li>
<li>If there was a new update it will receive each record byte by byte and it will continue receiving bytes until it finish the record then check if it was valid it will send <b>K</b> not valid will send <b>N</b> then it will repeat the sequence of receiving</li>
<li>If there wasn't update or there wasn't a valid application it will wait again for any update </li>
</ul>

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00079">79</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="main_8c_a6288eba0f8e8ad3ab1544ad731eb7667_cgraph.png" border="0" usemap="#amain_8c_a6288eba0f8e8ad3ab1544ad731eb7667_cgraph" alt=""/></div>
<map name="amain_8c_a6288eba0f8e8ad3ab1544ad731eb7667_cgraph" id="amain_8c_a6288eba0f8e8ad3ab1544ad731eb7667_cgraph">
<area shape="rect" title="The sequence of the bootloader." alt="" coords="5,427,55,453"/>
<area shape="rect" href="main_8c.html#a9c26879df40a5e80c53bcd969a9990c5" title="A function that set the start address of vector table and application." alt="" coords="135,31,305,57"/>
<area shape="poly" title=" " alt="" coords="29,426,35,352,47,244,68,138,83,96,101,68,119,54,122,58,105,71,87,98,73,139,52,245,40,352,35,426"/>
<area shape="rect" href="_m_g_p_i_o__program_8c.html#aae23291b921ddee3911bb797a5ea6c39" title="this function is responsible for setting the alternative function of any selected GPIO pins" alt="" coords="124,81,316,124"/>
<area shape="poly" title=" " alt="" coords="30,426,38,364,52,277,73,191,86,157,101,134,109,127,112,131,105,138,90,160,78,193,57,278,43,365,35,427"/>
<area shape="rect" href="_m_g_p_i_o__program_8c.html#a50c70acc1669a34bee9bd7350ea8bc77" title="this function is responsible for setting any pin mode of STM GPIO pins" alt="" coords="138,148,302,175"/>
<area shape="poly" title=" " alt="" coords="28,426,29,380,37,315,46,280,59,245,77,213,101,185,122,171,125,175,104,189,81,216,64,247,51,281,42,316,34,380,33,426"/>
<area shape="rect" href="_m_g_p_i_o__program_8c.html#af764d75a88a2476b5a14318c12b4fe3f" title="this function is responsible for setting the output configurations of any selected GPIO pin" alt="" coords="118,199,322,225"/>
<area shape="poly" title=" " alt="" coords="29,426,33,388,44,336,65,282,81,257,101,235,105,232,108,236,105,239,85,260,70,284,49,338,38,389,34,426"/>
<area shape="rect" href="_m_g_p_i_o__program_8c.html#ab3372184ad814036f3d8c2d1049197dd" title="this function is responsible for setting the value of any output GPIO pin" alt="" coords="137,249,303,276"/>
<area shape="poly" title=" " alt="" coords="31,426,38,396,51,358,71,319,101,286,121,274,124,278,104,290,76,322,56,360,43,398,36,427"/>
<area shape="rect" href="_m_r_c_c__program_8c.html#ac49a84d89c5353f52b922c73ff564848" title="This function responsible of Enabling the peripheral Clock From RCC." alt="" coords="127,300,313,327"/>
<area shape="poly" title=" " alt="" coords="35,425,59,381,78,357,101,337,111,331,114,335,104,341,82,360,63,384,39,427"/>
<area shape="rect" href="_m_r_c_c__program_8c.html#a0879ae818c01b453bb70df7caf0b9aa8" title="This function is responsible of Initializing Reset Clock Control." alt="" coords="167,351,273,377"/>
<area shape="poly" title=" " alt="" coords="45,424,70,405,102,387,151,371,153,376,104,392,73,409,48,428"/>
<area shape="rect" href="_m_s_t_k__program_8c.html#ab6a2d93c82b336dafa2aee648288f3d2" title="This funciton used to Control the Clock Source and the interrupt." alt="" coords="168,401,272,428"/>
<area shape="poly" title=" " alt="" coords="55,434,152,421,153,426,55,439"/>
<area shape="rect" href="_m_s_t_k__program_8c.html#af7f58dc44784b3beae339b00082ab320" title="This funciton is used to generate an interrupt after period of time." alt="" coords="119,452,321,479"/>
<area shape="poly" title=" " alt="" coords="55,441,104,447,103,452,55,446"/>
<area shape="rect" href="_m_s_t_k__program_8c.html#a482eb2588bdf9eb011893b931f336df4" title="This funciton is used to stop the counting at anytime in the system" alt="" coords="163,503,277,529"/>
<area shape="poly" title=" " alt="" coords="48,452,73,471,104,488,149,503,148,508,102,493,70,475,45,456"/>
<area shape="rect" href="_m_u_a_r_t__program_8c.html#ab24cb248f8359a8fe5fef2940825c66d" title="This function responsible of Receiving the data from UART1." alt="" coords="103,553,337,580"/>
<area shape="poly" title=" " alt="" coords="39,453,63,496,82,520,104,539,112,544,110,549,101,543,78,523,59,499,35,455"/>
<area shape="rect" href="_m_u_a_r_t__program_8c.html#a12f2cdb6c0a1eb35a953d74e99b7b3af" title="This function responsible of Enabling the interrupt of UART1." alt="" coords="149,604,291,631"/>
<area shape="poly" title=" " alt="" coords="36,453,43,482,56,520,76,558,104,590,135,606,133,611,101,594,71,561,51,522,38,484,31,454"/>
<area shape="rect" href="_m_u_a_r_t__program_8c.html#abd4611b2b2a144980010fb971d7529dd" title="This function responsible of Initializing UART1." alt="" coords="160,655,280,681"/>
<area shape="poly" title=" " alt="" coords="34,454,38,491,49,542,70,596,85,620,104,641,124,653,146,661,144,666,121,658,101,645,81,623,65,598,44,544,33,492,29,454"/>
<area shape="rect" href="_m_u_a_r_t__program_8c.html#a4336efc7e2876e47e705a9f37cc07769" title="This function responsible of Transmitting the data from UART1." alt="" coords="426,705,578,732"/>
<area shape="poly" title=" " alt="" coords="36,453,44,507,58,579,79,649,91,675,104,691,126,703,156,712,235,722,325,724,410,722,410,727,325,730,235,727,155,717,124,708,101,695,87,677,74,650,53,581,39,508,30,454"/>
<area shape="rect" href="_s_hex_parser__program_8c.html#a55e514bdc0ad365bc85f382ec6ff78d1" title="This function is responsible for parsing different types of Intel Hex records and taking appropriate ..." alt="" coords="117,756,323,799"/>
<area shape="poly" title=" " alt="" coords="36,453,58,599,79,681,91,714,105,736,115,745,111,749,101,739,86,716,74,683,53,600,30,454"/>
<area shape="rect" href="_s_hex_parser__program_8c.html#ad10fd560c8cb8b16d3a0744cc5c0fee7" title="This function to set a callback function that can be executed in response to specific conditions." alt="" coords="124,823,316,865"/>
<area shape="poly" title=" " alt="" coords="35,454,40,527,53,634,74,740,88,781,105,809,113,817,109,820,101,812,83,783,69,741,48,635,35,528,29,454"/>
<area shape="rect" href="_m_s_c_b__program_8c.html#a724b5aeeca3086037aafa4b685b5d7b8" title="This function set the vector table of the microcontroller." alt="" coords="413,5,590,32"/>
<area shape="poly" title=" " alt="" coords="305,34,397,25,398,31,305,39"/>
<area shape="rect" href="_m_s_t_k__program_8c.html#a06f7aa2eae169670786e8c13c7b04c70" title="This funciton is used to calculate the elapsed time from it starts to count." alt="" coords="411,56,593,83"/>
<area shape="poly" title=" " alt="" coords="305,49,396,57,395,62,305,54"/>
<area shape="poly" title=" " alt="" coords="323,753,419,733,420,738,324,758"/>
<area shape="rect" href="_s_hex_parser__program_8c.html#a9ca68304961ef7223393e8926b31b246" title="This Function responsible for parsing and processing a line of Intel Hexadecimal format data." alt="" coords="385,756,618,783"/>
<area shape="poly" title=" " alt="" coords="323,772,369,770,370,776,324,777"/>
<area shape="rect" href="_s_hex_parser__program_8c.html#a2cc74a9050ddd67bba341795a848947a" title="This function processes a specific type of data record in Intel Hex format." alt="" coords="406,807,598,849"/>
<area shape="poly" title=" " alt="" coords="324,793,390,805,389,811,323,799"/>
<area shape="rect" href="_s_hex_parser__program_8c.html#aec73bfe0ecca9c6aa09dba9abe47072d" title="This function is responsible for setting the start address for the application based on the data prov..." alt="" coords="406,873,598,916"/>
<area shape="poly" title=" " alt="" coords="315,797,338,808,354,821,363,834,372,847,387,859,395,864,393,869,383,864,368,851,359,838,350,825,336,813,313,802"/>
<area shape="rect" href="_m_f_m_i__program_8c.html#a5d074f47165e736bedfc24d37c32fb77" title="This function responsible for writing to flash memory for the specified Copy_u8DataLength from the Co..." alt="" coords="666,756,813,783"/>
<area shape="poly" title=" " alt="" coords="619,767,651,767,651,772,619,772"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a5059b2482ec12efa628ffcb5415dfa79" name="a5059b2482ec12efa628ffcb5415dfa79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5059b2482ec12efa628ffcb5415dfa79">&#9670;&#160;</a></span>EntryPoint</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_s_t_d___t_y_p_e_s_8h.html#af5d0313d23964b7ba53802e2bb5e5efa">pf</a> EntryPoint = <a class="el" href="_s_t_d___t_y_p_e_s_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The entry point of the application which will be jumped to it after the bootloader finish. </p>

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00027">27</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a id="ad0c6ac1573c545cef564e2662673979d" name="ad0c6ac1573c545cef564e2662673979d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0c6ac1573c545cef564e2662673979d">&#9670;&#160;</a></span>ReceiveBuffer</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_s_t_d___t_y_p_e_s_8h.html#a2ff401e087cf786c38a6812723e94473">s8</a> ReceiveBuffer[100]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This array will receive the new update records. </p>

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00023">23</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a id="ae5a7d330b0942455f9bb055921216ea9" name="ae5a7d330b0942455f9bb055921216ea9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5a7d330b0942455f9bb055921216ea9">&#9670;&#160;</a></span>TimeOutFlag</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile <a class="el" href="_s_t_d___t_y_p_e_s_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a> TimeOutFlag = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The time out flag which indicated that the bootloader has finished it task. </p>

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00025">25</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a id="ac1a38ba7894421299f56d8d39b4d6958" name="ac1a38ba7894421299f56d8d39b4d6958"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1a38ba7894421299f56d8d39b4d6958">&#9670;&#160;</a></span>u8RecCounter</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile <a class="el" href="_s_t_d___t_y_p_e_s_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a> u8RecCounter = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The record counter. </p>

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00024">24</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
<a id="ab771d0d041fa7fa0b7c0a52e5e6d0f19" name="ab771d0d041fa7fa0b7c0a52e5e6d0f19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab771d0d041fa7fa0b7c0a52e5e6d0f19">&#9670;&#160;</a></span>u8WriteReq</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile <a class="el" href="_s_t_d___t_y_p_e_s_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a> u8WriteReq = 1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This flag indicated for the start of writing in a bank. </p>

<p class="definition">Definition at line <a class="el" href="main_8c_source.html#l00026">26</a> of file <a class="el" href="main_8c_source.html">main.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="main_8c.html">main.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
